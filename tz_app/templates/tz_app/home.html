{% extends "admin/base_site.html" %}
{% load i18n l10n tz %}{% load url from future %}

{% block extrahead %}
<style type="text/css">
form { margin: .2em 0 .4em 0; }
label, span.label { display: inline-block; margin-right: 0.5em; text-align: right; width: 15em;}
div.module table { width: 100%; }
</style>
{% endblock %}

{% block content %}
<h2>Conversions in templates</h2>

<div class="module">
    <table>
        <caption>Conversions for now in UTC</caption>
        <tr>
            <th>localtime</th>
            <th>localize</th>
            <th>Default</th>
            <th>Local time</th>
            <th>Alternative time</th>
            <th>UTC</th>
        </tr>
{% localtime on %}
{% localize on %}
        <tr>
            <td>on</td>
            <td>on</td>
            <td>{{ utc_now }}</td>
            <td>{{ utc_now|aslocaltime }}</td>
            <td>{{ utc_now|astimezone:alt_timezone }}</td>
            <td>{{ utc_now|asutc }}</td>
        </tr>
{% endlocalize %}
{% localize off %}
        <tr>
            <td>on</td>
            <td>off</td>
            <td>{{ utc_now }}</td>
            <td>{{ utc_now|aslocaltime }}</td>
            <td>{{ utc_now|astimezone:alt_timezone }}</td>
            <td>{{ utc_now|asutc }}</td>
        </tr>
{% endlocalize %}
{% endlocaltime %}
{% localtime off %}
{% localize on %}
        <tr>
            <td>off</td>
            <td>on</td>
            <td>{{ utc_now }}</td>
            <td>{{ utc_now|aslocaltime }}</td>
            <td>{{ utc_now|astimezone:alt_timezone }}</td>
            <td>{{ utc_now|asutc }}</td>
        </tr>
{% endlocalize %}
{% localize off %}
        <tr>
            <td>off</td>
            <td>off</td>
            <td>{{ utc_now }}</td>
            <td>{{ utc_now|aslocaltime }}</td>
            <td>{{ utc_now|astimezone:alt_timezone }}</td>
            <td>{{ utc_now|asutc }}</td>
        </tr>
{% endlocalize %}
{% endlocaltime %}
    </table>
</div>

<div class="module">
    <table>
        <caption>Conversions for now in local time</caption>
        <tr>
            <th>localtime</th>
            <th>localize</th>
            <th>Default</th>
            <th>Local time</th>
            <th>Alternative time</th>
            <th>UTC</th>
        </tr>
{% localtime on %}
{% localize on %}
        <tr>
            <td>on</td>
            <td>on</td>
            <td>{{ local_now }}</td>
            <td>{{ local_now|aslocaltime }}</td>
            <td>{{ local_now|astimezone:alt_timezone }}</td>
            <td>{{ local_now|asutc }}</td>
        </tr>
{% endlocalize %}
{% localize off %}
        <tr>
            <td>on</td>
            <td>off</td>
            <td>{{ local_now }}</td>
            <td>{{ local_now|aslocaltime }}</td>
            <td>{{ local_now|astimezone:alt_timezone }}</td>
            <td>{{ local_now|asutc }}</td>
        </tr>
{% endlocalize %}
{% endlocaltime %}
{% localtime off %}
{% localize on %}
        <tr>
            <td>off</td>
            <td>on</td>
            <td>{{ local_now }}</td>
            <td>{{ local_now|aslocaltime }}</td>
            <td>{{ local_now|astimezone:alt_timezone }}</td>
            <td>{{ local_now|asutc }}</td>
        </tr>
{% endlocalize %}
{% localize off %}
        <tr>
            <td>off</td>
            <td>off</td>
            <td>{{ local_now }}</td>
            <td>{{ local_now|aslocaltime }}</td>
            <td>{{ local_now|astimezone:alt_timezone }}</td>
            <td>{{ local_now|asutc }}</td>
        </tr>
{% endlocalize %}
{% endlocaltime %}
    </table>
</div>

<div class="module">
    <table>
        <caption>Conversions for now as a naive datetime</caption>
        <tr>
            <th>localtime</th>
            <th>localize</th>
            <th>Default (no conversion!)</th>
            <th>Local time</th>
            <th>Alternative time</th>
            <th>UTC</th>
        </tr>
{% localtime on %}
{% localize on %}
        <tr>
            <td>on</td>
            <td>on</td>
            <td>{{ naive_now }}</td>
            <td>{{ naive_now|aslocaltime }}</td>
            <td>{{ naive_now|astimezone:alt_timezone }}</td>
            <td>{{ naive_now|asutc }}</td>
        </tr>
{% endlocalize %}
{% localize off %}
        <tr>
            <td>on</td>
            <td>off</td>
            <td>{{ naive_now }}</td>
            <td>{{ naive_now|aslocaltime }}</td>
            <td>{{ naive_now|astimezone:alt_timezone }}</td>
            <td>{{ naive_now|asutc }}</td>
        </tr>
{% endlocalize %}
{% endlocaltime %}
{% localtime off %}
{% localize on %}
        <tr>
            <td>off</td>
            <td>on</td>
            <td>{{ naive_now }}</td>
            <td>{{ naive_now|aslocaltime }}</td>
            <td>{{ naive_now|astimezone:alt_timezone }}</td>
            <td>{{ naive_now|asutc }}</td>
        </tr>
{% endlocalize %}
{% localize off %}
        <tr>
            <td>off</td>
            <td>off</td>
            <td>{{ naive_now }}</td>
            <td>{{ naive_now|aslocaltime }}</td>
            <td>{{ naive_now|astimezone:alt_timezone }}</td>
            <td>{{ naive_now|asutc }}</td>
        </tr>
{% endlocalize %}
{% endlocaltime %}
    </table>
</div>

<h2>Conversion in forms and widgets</h2>

<form action="{% url 'home' %}" method="GET">
{{ form.as_p }}
<p><span class="label"></span><input type="submit" value="Submit"> or <a href="{% url 'home' %}">reset</a></p>
</form>

{% if value %}
<p><span class="label">You set the value to</span> <strong>{{ value }} in {{ TIME_ZONE }}</strong></p>
<p><span class="label">which is</span> <strong>{{ value|unlocalize }}</strong></p>
<p><span class="label">and</span> <strong>{{ value|asutc|unlocalize }}</strong></p>
{% endif %}
{% if split_value %}
<p><span class="label">You set the split value to</span> <strong>{{ split_value }} in {{ TIME_ZONE }}</strong></p>
<p><span class="label">which is</span> <strong>{{ split_value|unlocalize }}</strong></p>
<p><span class="label">and</span> <strong>{{ split_value|asutc|unlocalize }}</strong></p>
{% endif %}

<h2>Conversions in models</h2>

<p>
    <a href="{% url 'admin:app_list' 'tz_app' %}">Go to the admin and add some objects.</a>
    Here is the contents of the database:
</p>

{% localize off %}{# datetimes are more readable in ISO format #}

<div class="module">
    <table>
        <caption>Name objects</caption>
        <tr>
            <th>Name</th>
            <th>Dated</th>
            <th>Dated (UTC)</th>
        </tr>
{% for name in names %}
        <tr>
            <td>{{ name.name }}</td>
            <td>{{ name.dated }}</td>
            <td>{{ name.dated|asutc }}</td>
        </tr>
{% endfor %}
    </table>
</div>

<div class="module">
    <table>
        <caption>Auto name objects</caption>
        <tr>
            <th>Name</th>
            <th>Created</th>
            <th>Updated</th>
        </tr>
{% for auto_name in auto_names %}
        <tr>
            <td>{{ auto_name.name }}</td>
            <td>{{ auto_name.created }}</td>
            <td>{{ auto_name.updated }}</td>
        </tr>
{% endfor %}
    </table>
</div>

{% endlocalize %}

{% endblock %}
